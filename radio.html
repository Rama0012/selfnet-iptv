<!doctype html>
<meta charset=utf-8>
<title>SelfStreaming</title>
<link rel=stylesheet href=css/bootstrap.min.css>
<link rel=icon href=favicon.ico>
<script src=js/jquery-2.0.3.min.js></script>
<script src=js/fixencoding.js></script>
<style>
#channel-list td:nth-child(-n+2) {
	cursor: pointer;
}
</style>
<div class="container">
    <div class="page-header text-center">
        <a href=/><img src=img/selfstreaming.png alt=SelfStreaming height=58 width=382></a>
        <p class=lead>SelfStreaming also has some radio channels
    </div>

    <h2>Radio Channels</h2>
    <p>These channels are currently <strong>not</strong> announced via SAP. In most modern browsers, you should be able to play them directly, otherwise you need to open the links in your media&nbsp;player.
    <p><audio id=player class=center style=display:none controls></audio>
    <table id=channel-list class="table table-hover">
        <thead><tr><th>Channel<th>Current Title<th>Website<th>Stream Link
        <tbody>
    </table>
    <hr>
    <p>If you have any questions or suggestions, <a href=mailto:support@selfnet.de>send us an email</a>.
</div>

<script>
$(function() {
	var player = $('#player').show();
	$.getJSON('radio/status.json', function(data) {
		data = data.icestats;
		for (var i in data.source) {
			var s = data.source[i];
			var name = s.server_name ? (s.server_name + (s.server_name == s.server_description ? '' : (' â€“ ' + s.server_description))) : s.mount;
			var stream = 'radio' + s.mount;
			var td1 = $('<td>').text(name);
			var td2 = $('<td>').text(s.title);
			var td3 = $('<td>').append($('<a>').attr('href', s.server_url).text(s.server_url));
			var td4 = $('<td>').append($('<a>').attr('href', stream).text('Link'));
			var tr = $('<tr>').append(td1, td2, td3, td4);
			tr.click({stream:stream, tr:tr}, function(e) {
				player.attr('src', e.data.stream).trigger('play');
				$('#channel-list tr').removeClass('active');
				e.data.tr.addClass('active');
			});
			$('#channel-list tbody').append(tr);
		}
	}).fail(function() {
		console.log('lol, error');
	});
});
</script>
